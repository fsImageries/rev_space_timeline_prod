(function(){"use strict";function R(_,t){return _+Math.random()*(t-_)}/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const ut="151",f="srgb",tt="srgb-linear",xt="display-p3";function k(_,t,s){return Math.max(t,Math.min(s,_))}function Mt(_,t){return(_%t+t)%t}function st(_,t,s){return(1-s)*_+s*t}class I{constructor(){I.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(t,s,e,i,n,r,h,c,o){const a=this.elements;return a[0]=t,a[1]=i,a[2]=h,a[3]=s,a[4]=n,a[5]=c,a[6]=e,a[7]=r,a[8]=o,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const s=this.elements,e=t.elements;return s[0]=e[0],s[1]=e[1],s[2]=e[2],s[3]=e[3],s[4]=e[4],s[5]=e[5],s[6]=e[6],s[7]=e[7],s[8]=e[8],this}extractBasis(t,s,e){return t.setFromMatrix3Column(this,0),s.setFromMatrix3Column(this,1),e.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const s=t.elements;return this.set(s[0],s[4],s[8],s[1],s[5],s[9],s[2],s[6],s[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,s){const e=t.elements,i=s.elements,n=this.elements,r=e[0],h=e[3],c=e[6],o=e[1],a=e[4],l=e[7],x=e[2],u=e[5],y=e[8],m=i[0],d=i[3],g=i[6],p=i[1],w=i[4],F=i[7],M=i[2],b=i[5],z=i[8];return n[0]=r*m+h*p+c*M,n[3]=r*d+h*w+c*b,n[6]=r*g+h*F+c*z,n[1]=o*m+a*p+l*M,n[4]=o*d+a*w+l*b,n[7]=o*g+a*F+l*z,n[2]=x*m+u*p+y*M,n[5]=x*d+u*w+y*b,n[8]=x*g+u*F+y*z,this}multiplyScalar(t){const s=this.elements;return s[0]*=t,s[3]*=t,s[6]*=t,s[1]*=t,s[4]*=t,s[7]*=t,s[2]*=t,s[5]*=t,s[8]*=t,this}determinant(){const t=this.elements,s=t[0],e=t[1],i=t[2],n=t[3],r=t[4],h=t[5],c=t[6],o=t[7],a=t[8];return s*r*a-s*h*o-e*n*a+e*h*c+i*n*o-i*r*c}invert(){const t=this.elements,s=t[0],e=t[1],i=t[2],n=t[3],r=t[4],h=t[5],c=t[6],o=t[7],a=t[8],l=a*r-h*o,x=h*c-a*n,u=o*n-r*c,y=s*l+e*x+i*u;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const m=1/y;return t[0]=l*m,t[1]=(i*o-a*e)*m,t[2]=(h*e-i*r)*m,t[3]=x*m,t[4]=(a*s-i*c)*m,t[5]=(i*n-h*s)*m,t[6]=u*m,t[7]=(e*c-o*s)*m,t[8]=(r*s-e*n)*m,this}transpose(){let t;const s=this.elements;return t=s[1],s[1]=s[3],s[3]=t,t=s[2],s[2]=s[6],s[6]=t,t=s[5],s[5]=s[7],s[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const s=this.elements;return t[0]=s[0],t[1]=s[3],t[2]=s[6],t[3]=s[1],t[4]=s[4],t[5]=s[7],t[6]=s[2],t[7]=s[5],t[8]=s[8],this}setUvTransform(t,s,e,i,n,r,h){const c=Math.cos(n),o=Math.sin(n);return this.set(e*c,e*o,-e*(c*r+o*h)+r+t,-i*o,i*c,-i*(-o*r+c*h)+h+s,0,0,1),this}scale(t,s){return this.premultiply(et.makeScale(t,s)),this}rotate(t){return this.premultiply(et.makeRotation(-t)),this}translate(t,s){return this.premultiply(et.makeTranslation(t,s)),this}makeTranslation(t,s){return this.set(1,0,t,0,1,s,0,0,1),this}makeRotation(t){const s=Math.cos(t),e=Math.sin(t);return this.set(s,-e,0,e,s,0,0,0,1),this}makeScale(t,s){return this.set(t,0,0,0,s,0,0,0,1),this}equals(t){const s=this.elements,e=t.elements;for(let i=0;i<9;i++)if(s[i]!==e[i])return!1;return!0}fromArray(t,s=0){for(let e=0;e<9;e++)this.elements[e]=t[e+s];return this}toArray(t=[],s=0){const e=this.elements;return t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3],t[s+4]=e[4],t[s+5]=e[5],t[s+6]=e[6],t[s+7]=e[7],t[s+8]=e[8],t}clone(){return new this.constructor().fromArray(this.elements)}}const et=new I;function it(_){return _<.04045?_*.0773993808:Math.pow(_*.9478672986+.0521327014,2.4)}function nt(_){return _<.0031308?_*12.92:1.055*Math.pow(_,.41666)-.055}const Ft=new I().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),bt=new I().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);function pt(_){return _.convertSRGBToLinear().applyMatrix3(bt)}function wt(_){return _.applyMatrix3(Ft).convertLinearToSRGB()}const Ct={[tt]:_=>_,[f]:_=>_.convertSRGBToLinear(),[xt]:pt},kt={[tt]:_=>_,[f]:_=>_.convertLinearToSRGB(),[xt]:wt},E={enabled:!1,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(_){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!_},get workingColorSpace(){return tt},set workingColorSpace(_){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(_,t,s){if(this.enabled===!1||t===s||!t||!s)return _;const e=Ct[t],i=kt[s];if(e===void 0||i===void 0)throw new Error(`Unsupported color space conversion, "${t}" to "${s}".`);return i(e(_))},fromWorkingColorSpace:function(_,t){return this.convert(_,this.workingColorSpace,t)},toWorkingColorSpace:function(_,t){return this.convert(_,t,this.workingColorSpace)}};class ht{constructor(t=0,s=0,e=0,i=1){this.isQuaternion=!0,this._x=t,this._y=s,this._z=e,this._w=i}static slerpFlat(t,s,e,i,n,r,h){let c=e[i+0],o=e[i+1],a=e[i+2],l=e[i+3];const x=n[r+0],u=n[r+1],y=n[r+2],m=n[r+3];if(h===0){t[s+0]=c,t[s+1]=o,t[s+2]=a,t[s+3]=l;return}if(h===1){t[s+0]=x,t[s+1]=u,t[s+2]=y,t[s+3]=m;return}if(l!==m||c!==x||o!==u||a!==y){let d=1-h;const g=c*x+o*u+a*y+l*m,p=g>=0?1:-1,w=1-g*g;if(w>Number.EPSILON){const M=Math.sqrt(w),b=Math.atan2(M,g*p);d=Math.sin(d*b)/M,h=Math.sin(h*b)/M}const F=h*p;if(c=c*d+x*F,o=o*d+u*F,a=a*d+y*F,l=l*d+m*F,d===1-h){const M=1/Math.sqrt(c*c+o*o+a*a+l*l);c*=M,o*=M,a*=M,l*=M}}t[s]=c,t[s+1]=o,t[s+2]=a,t[s+3]=l}static multiplyQuaternionsFlat(t,s,e,i,n,r){const h=e[i],c=e[i+1],o=e[i+2],a=e[i+3],l=n[r],x=n[r+1],u=n[r+2],y=n[r+3];return t[s]=h*y+a*l+c*u-o*x,t[s+1]=c*y+a*x+o*l-h*u,t[s+2]=o*y+a*u+h*x-c*l,t[s+3]=a*y-h*l-c*x-o*u,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,s,e,i){return this._x=t,this._y=s,this._z=e,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,s){const e=t._x,i=t._y,n=t._z,r=t._order,h=Math.cos,c=Math.sin,o=h(e/2),a=h(i/2),l=h(n/2),x=c(e/2),u=c(i/2),y=c(n/2);switch(r){case"XYZ":this._x=x*a*l+o*u*y,this._y=o*u*l-x*a*y,this._z=o*a*y+x*u*l,this._w=o*a*l-x*u*y;break;case"YXZ":this._x=x*a*l+o*u*y,this._y=o*u*l-x*a*y,this._z=o*a*y-x*u*l,this._w=o*a*l+x*u*y;break;case"ZXY":this._x=x*a*l-o*u*y,this._y=o*u*l+x*a*y,this._z=o*a*y+x*u*l,this._w=o*a*l-x*u*y;break;case"ZYX":this._x=x*a*l-o*u*y,this._y=o*u*l+x*a*y,this._z=o*a*y-x*u*l,this._w=o*a*l+x*u*y;break;case"YZX":this._x=x*a*l+o*u*y,this._y=o*u*l+x*a*y,this._z=o*a*y-x*u*l,this._w=o*a*l-x*u*y;break;case"XZY":this._x=x*a*l-o*u*y,this._y=o*u*l-x*a*y,this._z=o*a*y+x*u*l,this._w=o*a*l+x*u*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+r)}return s!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,s){const e=s/2,i=Math.sin(e);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(e),this._onChangeCallback(),this}setFromRotationMatrix(t){const s=t.elements,e=s[0],i=s[4],n=s[8],r=s[1],h=s[5],c=s[9],o=s[2],a=s[6],l=s[10],x=e+h+l;if(x>0){const u=.5/Math.sqrt(x+1);this._w=.25/u,this._x=(a-c)*u,this._y=(n-o)*u,this._z=(r-i)*u}else if(e>h&&e>l){const u=2*Math.sqrt(1+e-h-l);this._w=(a-c)/u,this._x=.25*u,this._y=(i+r)/u,this._z=(n+o)/u}else if(h>l){const u=2*Math.sqrt(1+h-e-l);this._w=(n-o)/u,this._x=(i+r)/u,this._y=.25*u,this._z=(c+a)/u}else{const u=2*Math.sqrt(1+l-e-h);this._w=(r-i)/u,this._x=(n+o)/u,this._y=(c+a)/u,this._z=.25*u}return this._onChangeCallback(),this}setFromUnitVectors(t,s){let e=t.dot(s)+1;return e<Number.EPSILON?(e=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=e):(this._x=0,this._y=-t.z,this._z=t.y,this._w=e)):(this._x=t.y*s.z-t.z*s.y,this._y=t.z*s.x-t.x*s.z,this._z=t.x*s.y-t.y*s.x,this._w=e),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(k(this.dot(t),-1,1)))}rotateTowards(t,s){const e=this.angleTo(t);if(e===0)return this;const i=Math.min(1,s/e);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,s){const e=t._x,i=t._y,n=t._z,r=t._w,h=s._x,c=s._y,o=s._z,a=s._w;return this._x=e*a+r*h+i*o-n*c,this._y=i*a+r*c+n*h-e*o,this._z=n*a+r*o+e*c-i*h,this._w=r*a-e*h-i*c-n*o,this._onChangeCallback(),this}slerp(t,s){if(s===0)return this;if(s===1)return this.copy(t);const e=this._x,i=this._y,n=this._z,r=this._w;let h=r*t._w+e*t._x+i*t._y+n*t._z;if(h<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,h=-h):this.copy(t),h>=1)return this._w=r,this._x=e,this._y=i,this._z=n,this;const c=1-h*h;if(c<=Number.EPSILON){const u=1-s;return this._w=u*r+s*this._w,this._x=u*e+s*this._x,this._y=u*i+s*this._y,this._z=u*n+s*this._z,this.normalize(),this._onChangeCallback(),this}const o=Math.sqrt(c),a=Math.atan2(o,h),l=Math.sin((1-s)*a)/o,x=Math.sin(s*a)/o;return this._w=r*l+this._w*x,this._x=e*l+this._x*x,this._y=i*l+this._y*x,this._z=n*l+this._z*x,this._onChangeCallback(),this}slerpQuaternions(t,s,e){return this.copy(t).slerp(s,e)}random(){const t=Math.random(),s=Math.sqrt(1-t),e=Math.sqrt(t),i=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(s*Math.cos(i),e*Math.sin(n),e*Math.cos(n),s*Math.sin(i))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,s=0){return this._x=t[s],this._y=t[s+1],this._z=t[s+2],this._w=t[s+3],this._onChangeCallback(),this}toArray(t=[],s=0){return t[s]=this._x,t[s+1]=this._y,t[s+2]=this._z,t[s+3]=this._w,t}fromBufferAttribute(t,s){return this._x=t.getX(s),this._y=t.getY(s),this._z=t.getZ(s),this._w=t.getW(s),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class A{constructor(t=0,s=0,e=0){A.prototype.isVector3=!0,this.x=t,this.y=s,this.z=e}set(t,s,e){return e===void 0&&(e=this.z),this.x=t,this.y=s,this.z=e,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,s){switch(t){case 0:this.x=s;break;case 1:this.y=s;break;case 2:this.z=s;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,s){return this.x=t.x+s.x,this.y=t.y+s.y,this.z=t.z+s.z,this}addScaledVector(t,s){return this.x+=t.x*s,this.y+=t.y*s,this.z+=t.z*s,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,s){return this.x=t.x-s.x,this.y=t.y-s.y,this.z=t.z-s.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,s){return this.x=t.x*s.x,this.y=t.y*s.y,this.z=t.z*s.z,this}applyEuler(t){return this.applyQuaternion(_t.setFromEuler(t))}applyAxisAngle(t,s){return this.applyQuaternion(_t.setFromAxisAngle(t,s))}applyMatrix3(t){const s=this.x,e=this.y,i=this.z,n=t.elements;return this.x=n[0]*s+n[3]*e+n[6]*i,this.y=n[1]*s+n[4]*e+n[7]*i,this.z=n[2]*s+n[5]*e+n[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const s=this.x,e=this.y,i=this.z,n=t.elements,r=1/(n[3]*s+n[7]*e+n[11]*i+n[15]);return this.x=(n[0]*s+n[4]*e+n[8]*i+n[12])*r,this.y=(n[1]*s+n[5]*e+n[9]*i+n[13])*r,this.z=(n[2]*s+n[6]*e+n[10]*i+n[14])*r,this}applyQuaternion(t){const s=this.x,e=this.y,i=this.z,n=t.x,r=t.y,h=t.z,c=t.w,o=c*s+r*i-h*e,a=c*e+h*s-n*i,l=c*i+n*e-r*s,x=-n*s-r*e-h*i;return this.x=o*c+x*-n+a*-h-l*-r,this.y=a*c+x*-r+l*-n-o*-h,this.z=l*c+x*-h+o*-r-a*-n,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const s=this.x,e=this.y,i=this.z,n=t.elements;return this.x=n[0]*s+n[4]*e+n[8]*i,this.y=n[1]*s+n[5]*e+n[9]*i,this.z=n[2]*s+n[6]*e+n[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,s){return this.x=Math.max(t.x,Math.min(s.x,this.x)),this.y=Math.max(t.y,Math.min(s.y,this.y)),this.z=Math.max(t.z,Math.min(s.z,this.z)),this}clampScalar(t,s){return this.x=Math.max(t,Math.min(s,this.x)),this.y=Math.max(t,Math.min(s,this.y)),this.z=Math.max(t,Math.min(s,this.z)),this}clampLength(t,s){const e=this.length();return this.divideScalar(e||1).multiplyScalar(Math.max(t,Math.min(s,e)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,s){return this.x+=(t.x-this.x)*s,this.y+=(t.y-this.y)*s,this.z+=(t.z-this.z)*s,this}lerpVectors(t,s,e){return this.x=t.x+(s.x-t.x)*e,this.y=t.y+(s.y-t.y)*e,this.z=t.z+(s.z-t.z)*e,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,s){const e=t.x,i=t.y,n=t.z,r=s.x,h=s.y,c=s.z;return this.x=i*c-n*h,this.y=n*r-e*c,this.z=e*h-i*r,this}projectOnVector(t){const s=t.lengthSq();if(s===0)return this.set(0,0,0);const e=t.dot(this)/s;return this.copy(t).multiplyScalar(e)}projectOnPlane(t){return rt.copy(this).projectOnVector(t),this.sub(rt)}reflect(t){return this.sub(rt.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const s=Math.sqrt(this.lengthSq()*t.lengthSq());if(s===0)return Math.PI/2;const e=this.dot(t)/s;return Math.acos(k(e,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const s=this.x-t.x,e=this.y-t.y,i=this.z-t.z;return s*s+e*e+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,s,e){const i=Math.sin(s)*t;return this.x=i*Math.sin(e),this.y=Math.cos(s)*t,this.z=i*Math.cos(e),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,s,e){return this.x=t*Math.sin(s),this.y=e,this.z=t*Math.cos(s),this}setFromMatrixPosition(t){const s=t.elements;return this.x=s[12],this.y=s[13],this.z=s[14],this}setFromMatrixScale(t){const s=this.setFromMatrixColumn(t,0).length(),e=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=s,this.y=e,this.z=i,this}setFromMatrixColumn(t,s){return this.fromArray(t.elements,s*4)}setFromMatrix3Column(t,s){return this.fromArray(t.elements,s*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,s=0){return this.x=t[s],this.y=t[s+1],this.z=t[s+2],this}toArray(t=[],s=0){return t[s]=this.x,t[s+1]=this.y,t[s+2]=this.z,t}fromBufferAttribute(t,s){return this.x=t.getX(s),this.y=t.getY(s),this.z=t.getZ(s),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=(Math.random()-.5)*2,s=Math.random()*Math.PI*2,e=Math.sqrt(1-t**2);return this.x=e*Math.cos(s),this.y=e*Math.sin(s),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const rt=new A,_t=new ht;class q{constructor(){q.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(t,s,e,i,n,r,h,c,o,a,l,x,u,y,m,d){const g=this.elements;return g[0]=t,g[4]=s,g[8]=e,g[12]=i,g[1]=n,g[5]=r,g[9]=h,g[13]=c,g[2]=o,g[6]=a,g[10]=l,g[14]=x,g[3]=u,g[7]=y,g[11]=m,g[15]=d,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new q().fromArray(this.elements)}copy(t){const s=this.elements,e=t.elements;return s[0]=e[0],s[1]=e[1],s[2]=e[2],s[3]=e[3],s[4]=e[4],s[5]=e[5],s[6]=e[6],s[7]=e[7],s[8]=e[8],s[9]=e[9],s[10]=e[10],s[11]=e[11],s[12]=e[12],s[13]=e[13],s[14]=e[14],s[15]=e[15],this}copyPosition(t){const s=this.elements,e=t.elements;return s[12]=e[12],s[13]=e[13],s[14]=e[14],this}setFromMatrix3(t){const s=t.elements;return this.set(s[0],s[3],s[6],0,s[1],s[4],s[7],0,s[2],s[5],s[8],0,0,0,0,1),this}extractBasis(t,s,e){return t.setFromMatrixColumn(this,0),s.setFromMatrixColumn(this,1),e.setFromMatrixColumn(this,2),this}makeBasis(t,s,e){return this.set(t.x,s.x,e.x,0,t.y,s.y,e.y,0,t.z,s.z,e.z,0,0,0,0,1),this}extractRotation(t){const s=this.elements,e=t.elements,i=1/L.setFromMatrixColumn(t,0).length(),n=1/L.setFromMatrixColumn(t,1).length(),r=1/L.setFromMatrixColumn(t,2).length();return s[0]=e[0]*i,s[1]=e[1]*i,s[2]=e[2]*i,s[3]=0,s[4]=e[4]*n,s[5]=e[5]*n,s[6]=e[6]*n,s[7]=0,s[8]=e[8]*r,s[9]=e[9]*r,s[10]=e[10]*r,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,this}makeRotationFromEuler(t){const s=this.elements,e=t.x,i=t.y,n=t.z,r=Math.cos(e),h=Math.sin(e),c=Math.cos(i),o=Math.sin(i),a=Math.cos(n),l=Math.sin(n);if(t.order==="XYZ"){const x=r*a,u=r*l,y=h*a,m=h*l;s[0]=c*a,s[4]=-c*l,s[8]=o,s[1]=u+y*o,s[5]=x-m*o,s[9]=-h*c,s[2]=m-x*o,s[6]=y+u*o,s[10]=r*c}else if(t.order==="YXZ"){const x=c*a,u=c*l,y=o*a,m=o*l;s[0]=x+m*h,s[4]=y*h-u,s[8]=r*o,s[1]=r*l,s[5]=r*a,s[9]=-h,s[2]=u*h-y,s[6]=m+x*h,s[10]=r*c}else if(t.order==="ZXY"){const x=c*a,u=c*l,y=o*a,m=o*l;s[0]=x-m*h,s[4]=-r*l,s[8]=y+u*h,s[1]=u+y*h,s[5]=r*a,s[9]=m-x*h,s[2]=-r*o,s[6]=h,s[10]=r*c}else if(t.order==="ZYX"){const x=r*a,u=r*l,y=h*a,m=h*l;s[0]=c*a,s[4]=y*o-u,s[8]=x*o+m,s[1]=c*l,s[5]=m*o+x,s[9]=u*o-y,s[2]=-o,s[6]=h*c,s[10]=r*c}else if(t.order==="YZX"){const x=r*c,u=r*o,y=h*c,m=h*o;s[0]=c*a,s[4]=m-x*l,s[8]=y*l+u,s[1]=l,s[5]=r*a,s[9]=-h*a,s[2]=-o*a,s[6]=u*l+y,s[10]=x-m*l}else if(t.order==="XZY"){const x=r*c,u=r*o,y=h*c,m=h*o;s[0]=c*a,s[4]=-l,s[8]=o*a,s[1]=x*l+m,s[5]=r*a,s[9]=u*l-y,s[2]=y*l-u,s[6]=h*a,s[10]=m*l+x}return s[3]=0,s[7]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Et,t,St)}lookAt(t,s,e){const i=this.elements;return S.subVectors(t,s),S.lengthSq()===0&&(S.z=1),S.normalize(),T.crossVectors(e,S),T.lengthSq()===0&&(Math.abs(e.z)===1?S.x+=1e-4:S.z+=1e-4,S.normalize(),T.crossVectors(e,S)),T.normalize(),H.crossVectors(S,T),i[0]=T.x,i[4]=H.x,i[8]=S.x,i[1]=T.y,i[5]=H.y,i[9]=S.y,i[2]=T.z,i[6]=H.z,i[10]=S.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,s){const e=t.elements,i=s.elements,n=this.elements,r=e[0],h=e[4],c=e[8],o=e[12],a=e[1],l=e[5],x=e[9],u=e[13],y=e[2],m=e[6],d=e[10],g=e[14],p=e[3],w=e[7],F=e[11],M=e[15],b=i[0],z=i[4],Z=i[8],X=i[12],N=i[1],G=i[5],$=i[9],V=i[13],Q=i[2],W=i[6],j=i[10],U=i[14],J=i[3],K=i[7],O=i[11],v=i[15];return n[0]=r*b+h*N+c*Q+o*J,n[4]=r*z+h*G+c*W+o*K,n[8]=r*Z+h*$+c*j+o*O,n[12]=r*X+h*V+c*U+o*v,n[1]=a*b+l*N+x*Q+u*J,n[5]=a*z+l*G+x*W+u*K,n[9]=a*Z+l*$+x*j+u*O,n[13]=a*X+l*V+x*U+u*v,n[2]=y*b+m*N+d*Q+g*J,n[6]=y*z+m*G+d*W+g*K,n[10]=y*Z+m*$+d*j+g*O,n[14]=y*X+m*V+d*U+g*v,n[3]=p*b+w*N+F*Q+M*J,n[7]=p*z+w*G+F*W+M*K,n[11]=p*Z+w*$+F*j+M*O,n[15]=p*X+w*V+F*U+M*v,this}multiplyScalar(t){const s=this.elements;return s[0]*=t,s[4]*=t,s[8]*=t,s[12]*=t,s[1]*=t,s[5]*=t,s[9]*=t,s[13]*=t,s[2]*=t,s[6]*=t,s[10]*=t,s[14]*=t,s[3]*=t,s[7]*=t,s[11]*=t,s[15]*=t,this}determinant(){const t=this.elements,s=t[0],e=t[4],i=t[8],n=t[12],r=t[1],h=t[5],c=t[9],o=t[13],a=t[2],l=t[6],x=t[10],u=t[14],y=t[3],m=t[7],d=t[11],g=t[15];return y*(+n*c*l-i*o*l-n*h*x+e*o*x+i*h*u-e*c*u)+m*(+s*c*u-s*o*x+n*r*x-i*r*u+i*o*a-n*c*a)+d*(+s*o*l-s*h*u-n*r*l+e*r*u+n*h*a-e*o*a)+g*(-i*h*a-s*c*l+s*h*x+i*r*l-e*r*x+e*c*a)}transpose(){const t=this.elements;let s;return s=t[1],t[1]=t[4],t[4]=s,s=t[2],t[2]=t[8],t[8]=s,s=t[6],t[6]=t[9],t[9]=s,s=t[3],t[3]=t[12],t[12]=s,s=t[7],t[7]=t[13],t[13]=s,s=t[11],t[11]=t[14],t[14]=s,this}setPosition(t,s,e){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=s,i[14]=e),this}invert(){const t=this.elements,s=t[0],e=t[1],i=t[2],n=t[3],r=t[4],h=t[5],c=t[6],o=t[7],a=t[8],l=t[9],x=t[10],u=t[11],y=t[12],m=t[13],d=t[14],g=t[15],p=l*d*o-m*x*o+m*c*u-h*d*u-l*c*g+h*x*g,w=y*x*o-a*d*o-y*c*u+r*d*u+a*c*g-r*x*g,F=a*m*o-y*l*o+y*h*u-r*m*u-a*h*g+r*l*g,M=y*l*c-a*m*c-y*h*x+r*m*x+a*h*d-r*l*d,b=s*p+e*w+i*F+n*M;if(b===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const z=1/b;return t[0]=p*z,t[1]=(m*x*n-l*d*n-m*i*u+e*d*u+l*i*g-e*x*g)*z,t[2]=(h*d*n-m*c*n+m*i*o-e*d*o-h*i*g+e*c*g)*z,t[3]=(l*c*n-h*x*n-l*i*o+e*x*o+h*i*u-e*c*u)*z,t[4]=w*z,t[5]=(a*d*n-y*x*n+y*i*u-s*d*u-a*i*g+s*x*g)*z,t[6]=(y*c*n-r*d*n-y*i*o+s*d*o+r*i*g-s*c*g)*z,t[7]=(r*x*n-a*c*n+a*i*o-s*x*o-r*i*u+s*c*u)*z,t[8]=F*z,t[9]=(y*l*n-a*m*n-y*e*u+s*m*u+a*e*g-s*l*g)*z,t[10]=(r*m*n-y*h*n+y*e*o-s*m*o-r*e*g+s*h*g)*z,t[11]=(a*h*n-r*l*n-a*e*o+s*l*o+r*e*u-s*h*u)*z,t[12]=M*z,t[13]=(a*m*i-y*l*i+y*e*x-s*m*x-a*e*d+s*l*d)*z,t[14]=(y*h*i-r*m*i-y*e*c+s*m*c+r*e*d-s*h*d)*z,t[15]=(r*l*i-a*h*i+a*e*c-s*l*c-r*e*x+s*h*x)*z,this}scale(t){const s=this.elements,e=t.x,i=t.y,n=t.z;return s[0]*=e,s[4]*=i,s[8]*=n,s[1]*=e,s[5]*=i,s[9]*=n,s[2]*=e,s[6]*=i,s[10]*=n,s[3]*=e,s[7]*=i,s[11]*=n,this}getMaxScaleOnAxis(){const t=this.elements,s=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],e=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(s,e,i))}makeTranslation(t,s,e){return this.set(1,0,0,t,0,1,0,s,0,0,1,e,0,0,0,1),this}makeRotationX(t){const s=Math.cos(t),e=Math.sin(t);return this.set(1,0,0,0,0,s,-e,0,0,e,s,0,0,0,0,1),this}makeRotationY(t){const s=Math.cos(t),e=Math.sin(t);return this.set(s,0,e,0,0,1,0,0,-e,0,s,0,0,0,0,1),this}makeRotationZ(t){const s=Math.cos(t),e=Math.sin(t);return this.set(s,-e,0,0,e,s,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,s){const e=Math.cos(s),i=Math.sin(s),n=1-e,r=t.x,h=t.y,c=t.z,o=n*r,a=n*h;return this.set(o*r+e,o*h-i*c,o*c+i*h,0,o*h+i*c,a*h+e,a*c-i*r,0,o*c-i*h,a*c+i*r,n*c*c+e,0,0,0,0,1),this}makeScale(t,s,e){return this.set(t,0,0,0,0,s,0,0,0,0,e,0,0,0,0,1),this}makeShear(t,s,e,i,n,r){return this.set(1,e,n,0,t,1,r,0,s,i,1,0,0,0,0,1),this}compose(t,s,e){const i=this.elements,n=s._x,r=s._y,h=s._z,c=s._w,o=n+n,a=r+r,l=h+h,x=n*o,u=n*a,y=n*l,m=r*a,d=r*l,g=h*l,p=c*o,w=c*a,F=c*l,M=e.x,b=e.y,z=e.z;return i[0]=(1-(m+g))*M,i[1]=(u+F)*M,i[2]=(y-w)*M,i[3]=0,i[4]=(u-F)*b,i[5]=(1-(x+g))*b,i[6]=(d+p)*b,i[7]=0,i[8]=(y+w)*z,i[9]=(d-p)*z,i[10]=(1-(x+m))*z,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,s,e){const i=this.elements;let n=L.set(i[0],i[1],i[2]).length();const r=L.set(i[4],i[5],i[6]).length(),h=L.set(i[8],i[9],i[10]).length();this.determinant()<0&&(n=-n),t.x=i[12],t.y=i[13],t.z=i[14],B.copy(this);const o=1/n,a=1/r,l=1/h;return B.elements[0]*=o,B.elements[1]*=o,B.elements[2]*=o,B.elements[4]*=a,B.elements[5]*=a,B.elements[6]*=a,B.elements[8]*=l,B.elements[9]*=l,B.elements[10]*=l,s.setFromRotationMatrix(B),e.x=n,e.y=r,e.z=h,this}makePerspective(t,s,e,i,n,r){const h=this.elements,c=2*n/(s-t),o=2*n/(e-i),a=(s+t)/(s-t),l=(e+i)/(e-i),x=-(r+n)/(r-n),u=-2*r*n/(r-n);return h[0]=c,h[4]=0,h[8]=a,h[12]=0,h[1]=0,h[5]=o,h[9]=l,h[13]=0,h[2]=0,h[6]=0,h[10]=x,h[14]=u,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(t,s,e,i,n,r){const h=this.elements,c=1/(s-t),o=1/(e-i),a=1/(r-n),l=(s+t)*c,x=(e+i)*o,u=(r+n)*a;return h[0]=2*c,h[4]=0,h[8]=0,h[12]=-l,h[1]=0,h[5]=2*o,h[9]=0,h[13]=-x,h[2]=0,h[6]=0,h[10]=-2*a,h[14]=-u,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(t){const s=this.elements,e=t.elements;for(let i=0;i<16;i++)if(s[i]!==e[i])return!1;return!0}fromArray(t,s=0){for(let e=0;e<16;e++)this.elements[e]=t[e+s];return this}toArray(t=[],s=0){const e=this.elements;return t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3],t[s+4]=e[4],t[s+5]=e[5],t[s+6]=e[6],t[s+7]=e[7],t[s+8]=e[8],t[s+9]=e[9],t[s+10]=e[10],t[s+11]=e[11],t[s+12]=e[12],t[s+13]=e[13],t[s+14]=e[14],t[s+15]=e[15],t}}const L=new A,B=new q,Et=new A(0,0,0),St=new A(1,1,1),T=new A,H=new A,S=new A,yt=new q,mt=new ht;class P{constructor(t=0,s=0,e=0,i=P.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=s,this._z=e,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,s,e,i=this._order){return this._x=t,this._y=s,this._z=e,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,s=this._order,e=!0){const i=t.elements,n=i[0],r=i[4],h=i[8],c=i[1],o=i[5],a=i[9],l=i[2],x=i[6],u=i[10];switch(s){case"XYZ":this._y=Math.asin(k(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-a,u),this._z=Math.atan2(-r,n)):(this._x=Math.atan2(x,o),this._z=0);break;case"YXZ":this._x=Math.asin(-k(a,-1,1)),Math.abs(a)<.9999999?(this._y=Math.atan2(h,u),this._z=Math.atan2(c,o)):(this._y=Math.atan2(-l,n),this._z=0);break;case"ZXY":this._x=Math.asin(k(x,-1,1)),Math.abs(x)<.9999999?(this._y=Math.atan2(-l,u),this._z=Math.atan2(-r,o)):(this._y=0,this._z=Math.atan2(c,n));break;case"ZYX":this._y=Math.asin(-k(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(x,u),this._z=Math.atan2(c,n)):(this._x=0,this._z=Math.atan2(-r,o));break;case"YZX":this._z=Math.asin(k(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-a,o),this._y=Math.atan2(-l,n)):(this._x=0,this._y=Math.atan2(h,u));break;case"XZY":this._z=Math.asin(-k(r,-1,1)),Math.abs(r)<.9999999?(this._x=Math.atan2(x,o),this._y=Math.atan2(h,n)):(this._x=Math.atan2(-a,u),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+s)}return this._order=s,e===!0&&this._onChangeCallback(),this}setFromQuaternion(t,s,e){return yt.makeRotationFromQuaternion(t),this.setFromRotationMatrix(yt,s,e)}setFromVector3(t,s=this._order){return this.set(t.x,t.y,t.z,s)}reorder(t){return mt.setFromEuler(this),this.setFromQuaternion(mt,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],s=0){return t[s]=this._x,t[s+1]=this._y,t[s+2]=this._z,t[s+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}P.DEFAULT_ORDER="XYZ";const gt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},D={h:0,s:0,l:0},Y={h:0,s:0,l:0};function ot(_,t,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?_+(t-_)*6*s:s<1/2?t:s<2/3?_+(t-_)*6*(2/3-s):_}class at{constructor(t,s,e){return this.isColor=!0,this.r=1,this.g=1,this.b=1,s===void 0&&e===void 0?this.set(t):this.setRGB(t,s,e)}set(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,s=f){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,E.toWorkingColorSpace(this,s),this}setRGB(t,s,e,i=E.workingColorSpace){return this.r=t,this.g=s,this.b=e,E.toWorkingColorSpace(this,i),this}setHSL(t,s,e,i=E.workingColorSpace){if(t=Mt(t,1),s=k(s,0,1),e=k(e,0,1),s===0)this.r=this.g=this.b=e;else{const n=e<=.5?e*(1+s):e+s-e*s,r=2*e-n;this.r=ot(r,n,t+1/3),this.g=ot(r,n,t),this.b=ot(r,n,t-1/3)}return E.toWorkingColorSpace(this,i),this}setStyle(t,s=f){function e(n){n!==void 0&&parseFloat(n)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(t)){let n;const r=i[1],h=i[2];switch(r){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,E.toWorkingColorSpace(this,s),e(n[4]),this;if(n=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,E.toWorkingColorSpace(this,s),e(n[4]),this;break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h)){const c=parseFloat(n[1])/360,o=parseFloat(n[2])/100,a=parseFloat(n[3])/100;return e(n[4]),this.setHSL(c,o,a,s)}break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(t)){const n=i[1],r=n.length;if(r===3)return this.setRGB(parseInt(n.charAt(0),16)/15,parseInt(n.charAt(1),16)/15,parseInt(n.charAt(2),16)/15,s);if(r===6)return this.setHex(parseInt(n,16),s);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,s);return this}setColorName(t,s=f){const e=gt[t.toLowerCase()];return e!==void 0?this.setHex(e,s):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=it(t.r),this.g=it(t.g),this.b=it(t.b),this}copyLinearToSRGB(t){return this.r=nt(t.r),this.g=nt(t.g),this.b=nt(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=f){return E.fromWorkingColorSpace(C.copy(this),t),k(C.r*255,0,255)<<16^k(C.g*255,0,255)<<8^k(C.b*255,0,255)<<0}getHexString(t=f){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,s=E.workingColorSpace){E.fromWorkingColorSpace(C.copy(this),s);const e=C.r,i=C.g,n=C.b,r=Math.max(e,i,n),h=Math.min(e,i,n);let c,o;const a=(h+r)/2;if(h===r)c=0,o=0;else{const l=r-h;switch(o=a<=.5?l/(r+h):l/(2-r-h),r){case e:c=(i-n)/l+(i<n?6:0);break;case i:c=(n-e)/l+2;break;case n:c=(e-i)/l+4;break}c/=6}return t.h=c,t.s=o,t.l=a,t}getRGB(t,s=E.workingColorSpace){return E.fromWorkingColorSpace(C.copy(this),s),t.r=C.r,t.g=C.g,t.b=C.b,t}getStyle(t=f){E.fromWorkingColorSpace(C.copy(this),t);const s=C.r,e=C.g,i=C.b;return t!==f?`color(${t} ${s.toFixed(3)} ${e.toFixed(3)} ${i.toFixed(3)})`:`rgb(${s*255|0},${e*255|0},${i*255|0})`}offsetHSL(t,s,e){return this.getHSL(D),D.h+=t,D.s+=s,D.l+=e,this.setHSL(D.h,D.s,D.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,s){return this.r=t.r+s.r,this.g=t.g+s.g,this.b=t.b+s.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,s){return this.r+=(t.r-this.r)*s,this.g+=(t.g-this.g)*s,this.b+=(t.b-this.b)*s,this}lerpColors(t,s,e){return this.r=t.r+(s.r-t.r)*e,this.g=t.g+(s.g-t.g)*e,this.b=t.b+(s.b-t.b)*e,this}lerpHSL(t,s){this.getHSL(D),t.getHSL(Y);const e=st(D.h,Y.h,s),i=st(D.s,Y.s,s),n=st(D.l,Y.l,s);return this.setHSL(e,i,n),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const s=this.r,e=this.g,i=this.b,n=t.elements;return this.r=n[0]*s+n[3]*e+n[6]*i,this.g=n[1]*s+n[4]*e+n[7]*i,this.b=n[2]*s+n[5]*e+n[8]*i,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,s=0){return this.r=t[s],this.g=t[s+1],this.b=t[s+2],this}toArray(t=[],s=0){return t[s]=this.r,t[s+1]=this.g,t[s+2]=this.b,t}fromBufferAttribute(t,s){return this.r=t.getX(s),this.g=t.getY(s),this.b=t.getZ(s),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const C=new at;at.NAMES=gt,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:ut}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=ut);const dt=(_,t,s)=>{const e=t.map((n,r)=>n-_[r]);return Math.sqrt(e[0]**2+e[1]**2+e[2]**2)<s},zt=(_,t=1)=>{const s=[0,0,0];let e=[0,0,0];for(;dt(e,s,_);)e=At(t);return e},At=(_=1)=>{const t=Math.random(),s=Math.random(),e=t*2*Math.PI,i=Math.acos(2*s-1),n=Math.cbrt(Math.random()),r=Math.sin(e),h=Math.cos(e),c=Math.sin(i),o=Math.cos(i),a=n*c*h,l=n*c*r,x=n*o;return[a*_,l*_,x*_]};function Bt(_,t,s=1,e=1){for(let i=0;i<_.length;i+=3){_[i+1]+=R(-e*t,e*t),_[i]+=R(-e*27.5*s,e*32.5*s),_[i+2]+=R(-e*32.5*s,e*27.5*s);const n=[_[i],_[i+1],_[i+2]];for(let r=0;r<_.length;r+=3){if(i==r)continue;const h=[_[r],_[r+1],_[r+2]];dt(h,n,e)&&(_[r+1]+=R(-e,e))}}return _}(function(){const _=new A,t=new P,s=new ht,e=new A;return function(i,n){const[r,h,c]=zt(n.distanceStart,n.distanceEnd);_.x=r,_.y=h,_.z=c,t.x=Math.random()*2*Math.PI,t.y=Math.random()*2*Math.PI,t.z=Math.random()*2*Math.PI,s.setFromEuler(t),e.x=e.y=e.z=R(2,1e3),i.compose(_,s,e)}})();const Dt=1e4,ft=67319e8,ct=.01,lt=.5;function Rt(_){return[(_[0]+R(ct,lt))%1,(_[1]+R(ct,lt))%1,(_[2]+R(ct,lt))%1]}function Tt(_){const t=_.distanceToParent+ft,s=(t-_.distanceToParent)/_.distScale,e=t/_.distScale,i=[];for(let n=0;n<Dt;n++){const[r,h,c]=zt(e,e+s);i.push(r,h,c)}return[i]}function Lt(_){let t=[];const s=[],e=new at("#ffffff"),i=360/_.count;for(let r=0;r<_.count;r++){const h=i*r,[c,o,a]=[Math.sin(h*(Math.PI/180))*_.radius,0,Math.cos(h*(Math.PI/180))*_.radius];t.push(c,o,a),_.genColor&&s.push(...Rt([e.r,e.g,e.b]))}return t=Bt(t,_.height,_.end),_.genColor?[t,s]:[t]}onmessage=({data:_})=>{let t;switch(_.type){case"oortcloud":t=Tt(_);break;case"particlering":t=Lt(_)}t&&postMessage(t)}})();
